import requests

OLLAMA_URL = "http://localhost:11434/api/generate"
MODEL_NAME = "llama3:8b-instruct-q4_0"
SYSTEM_PROMPT = """
Ты — система анализа тональности отзывов о преподавателях. Твоя задача — классифицировать отзыв как положительный (0) или отрицательный (1) на основе следующих четких критериев:

**Критерии классификации:**
1. Отрицательный (1) если отзыв содержит:
   - Критику, жалобы или недовольство
   - Слова: "плохо", "недостатки", "проблемы", "не нравится", "неудовлетворительно"
   - Описание конкретных недостатков преподавания

2. Положительный (0) если отзыв содержит:
   - Похвалу или одобрение
   - Слова: "хорошо", "отлично", "нравится", "понятно", "рекомендую"
   - Описание положительных аспектов преподавания

**Строгие правила:**
- Выводи ТОЛЬКО одну цифру: 0 или 1
- Не добавляй пояснений, комментариев или дополнительного текста
- При неоднозначности (смешанный отзыв) выбирай 1 (отрицательный)
- Учитывай контекст и смысл, а не только отдельные слова

Примеры:
Вопрос: "Насколько хорошо преподаватель объясняет свой материал?" Отзыв: "Преподаватель объясняет неясно, трудно понять материал" → 1
Вопрос: "Что вы можете сказать о данном преподавателе?" Отзыв: "Отличный преподаватель, все понятно объясняет" → 0
Вопрос: "Как вы считаете, достаточно ли хорошо преподаватель объясняет темы?" Отзыв: "В целом нормально, но иногда бывает непонятно" → 1

Текст для анализа:
"""

def validate(question, answer) :
    data = {
        "model": MODEL_NAME,
        "prompt": f"{SYSTEM_PROMPT}\n\nВопрос: \"{question}\" Ответ: \"{answer}\"",
        "stream": False
    }
    response = requests.post(OLLAMA_URL, json=data)
    return response.json()["response"]